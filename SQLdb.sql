
/*   1 Inner join : WHICH PRODUCT WAS PURCHASED FROM WHICH CITY*/

select product_order.menu_item_no, subway_branch.SUBWAY_CITY from product_order 
	inner join subway_branch on product_order.subway_id=SUBWAY_BRANCH.SUBWAY_ID;
/*
Item_no	Subway_City
10	BRIDGEPORT
10	BRIDGEPORT
12	FAIRFIELD
14	FAIRFIELD
16	BRIDGEPORT */

/*  2 Inner Join : WHICH CUSTOMER GAVE WHAT REVIEW */


select customer_profile.First_name, customer_profile.last_name, customer_profile.cust_ID, Reviews.Feedback, Reviews.REVIEW_NUMBER from Reviews 
	inner join CUSTOMER_PROFILE on Reviews.CUSTOMER_PROFILE_CUST_ID=CUSTOMER_PROFILE.CUST_ID;

/*
First_name	last_name	Cust_id		Feedback	Review_Number
Rohit		Akole		1		GOOD		2001
Duhita		Dharma		2		EXCELLENT	2002
Rachna		Bharadwaj	3		BAD		2003
Sunil		Dudhe		4		V.GOOD		2004
Dhaval		Bulsara		5		BAD		2005
Duhita		Dharma		2		EXCELLENT	2006
*/

/*  3 LEFT Join : NAME OF THE EMPLOYEE AND THE PROPRITIER THEY WORK FOR */


SELECT Employees.employeename, employees.emp_id, subway_branch.subway_pro_name
	FROM EMPLOYEES
	LEFT JOIN Subway_branch ON Subway_branch.SUBWAY_ID = employees.subway_branch_subway_id
	ORDER BY employees.emp_id;
/*
Employeename	emp_id	subway_pro_name
SHASHANK  	1001	ALPHA
RAJ       	1002	ALPHA
KETAN     	1003	CATALYST
SAMUEL    	1004	ALPHA
AMILA     	1005	MAX
MAYANK    	1006	MAX
OLIVIA    	1007	LEXUS
NICK      	1008	MARKUS
SCHMITH   	1009	MARKUS
KSHITIJ   	1010	CATALYST

*/

/*  4 Group by :  NUMBER OF SIMILAR SALARIES, THE COUNT AND SALARY AMOUNT */


SELECT COUNT(salary_id), SALARY_AMOUNT
FROM salary
group by SALARY_AMOUNT
HAVING salary_amount > 5000
ORDER BY COUNT(salary_id) DESC;

/*
Count(salary_id)	Salary_amount
3			8000
2			25000
1			10000
*/

/*  5 AND Command: EMPLOYEES WHO ARE HELPERS AND JOINED AFTER JAN 2017 */


SELECT * FROM EMPLOYEES
WHERE EMP_JOIN_DATE > '01-JAN-2017' AND EMP_JOB_DESC LIKE 'HELPER';

/*
EMP_ID	EMP_NAME	EMP_JOB_DESC	EMP_JOIN_DATE	SUBWAY_BRANCH_SUBWAY_ID
1006	MAYANK    	HELPER		26-AUG-18	105
1008	NICK      	HELPER		08-NOV-17	103
*/


/*  6 LESS THAN DOB*/


select * from CUSTOMER_PROFILE where "D.O.B" < '01-jan-1994' and ZIP_CODE like '6604'; 

/*
1	1234567890	Rohit	Akole	12-DEC-92	4752257580	MALE  	6604	Atlantic	Bridgeport     
*/

/* 7 Find branches in location with specific customers*/

select * from subway_branch where SUBWAY_CITY like 'BRIDGEPORT' and (CUSTOMER_PROFILE_CUST_ID like '2' OR CUSTOMER_PROFILE_CUST_ID like '1');

/*
101	ALPHA		MAIN	BRIDGEPORT	6604	1
102	CATALYST	MAIN	BRIDGEPORT	6604	2
*/

/* 8 Fetch Menu card of selected hotel */

select * from menu where SUBWAY_BRANCH_SUBWAY_ID = '101';

/*
10	ROACHIC   	BBQCHIC	10	101
11	PANEER    	TTOFU	8	101
*/

/* 9 SELECT DELIVERY MODE AND PRODUCT DETAILS ALONG WITH THE BRANCH THAT TOOK THE ORDER.*/

select delivery_mode.delivery_mode_id, delivery_mode.delivery_type, DELIVERY_MODE.ORDER_NUMBER, PRODUCT_ORDER.TO_STREET, PRODUCT_ORDER.TO_ZIP, PRODUCT_ORDER.SUBWAY_ID FROM DELIVERY_MODE
    INNER JOIN PRODUCT_ORDER ON DELIVERY_MODE.ORDER_NUMBER=PRODUCT_ORDER.ORDER_NUMBER;

/*
201	TAKE-AWAY 	10	MAIN	6604	101
202	HOME-DEL  	11	RENNEL	6603	101
203	UBER-EATS 	12	RENNEL	6603	103
204	TAKE-AWAY 	13	MAIN	6604	103
205	HOME-DEL  	14	STATE	6604	105
*/

/* 10 BEST SEARCHED HOTEL AND HIGHEST RATINGS IN DESCENDING ORDER ALONG WITH REVIEWERS AND SUBWAY BRANCH DETAILS*/

SELECT REVIEWS.REVIEW_NUMBER, REVIEWS.FEEDBACK, REVIEWS.SEARCH_COUNT, CUSTOMER_PROFILE.fIRST_NAME, CUSTOMER_PROFILE.LAST_NAME, SUBWAY_BRANCH.SUBWAY_ID FROM REVIEWS
    INNER JOIN CUSTOMER_PROFILE ON REVIEWS.CUSTOMER_PROFILE_CUST_ID=CUSTOMER_PROFILE.CUST_ID
    INNER JOIN SUBWAY_BRANCH ON SUBWAY_BRANCH.SUBWAY_ID=REVIEWS.REF_SUB_ID ORDER BY REVIEWS.SEARCH_COUNT DESC;

/*
REV_NO	FEEDBACK	COUNT	FNAME	LNAME		SUBWAY_ID
2002	EXCELLENT	15	Duhita	Dharma		102
2006	EXCELLENT	15	Duhita	Dharma		102
2004	V.GOOD		13	Sunil	Dudhe		103
2001	GOOD		9	Rohit	Akole		101
2005	BAD		3	Dhaval	Bulsara		104
2003	BAD		2	Rachna	Bharadwaj	101
*/

/* 11 CONCATENATE*/

SELECT first_name||' '||last_name "CUSTOMER_NAME", STREET ||','||CITY||','||ZIP_CODE "ADDRESS" FROM CUSTOMER_PROFILE;

/*
CUSTOMER_NAME		ADDRESS
Rohit Akole		Atlantic,Bridgeport     ,6604
Duhita Dharma		RENNEL,Bridgeport    ,6604
Rachna Bharadwaj	MYRTLE,Bridgeport     ,6603
Sunil Dudhe		LINK,Fairfield      ,6603
Dhaval Bulsara		STATE,Fairfield      ,6603
*/

/* 12  UPDATE ROWS*/

UPDATE SUBWAY_BRANCH
SET SUBWAY_CITY= 'TRUMBULL', SUBWAY_STREET= 'PARKAVE'
WHERE SUBWAY_STREET LIKE 'LINK';

/*
101	ALPHA		MAIN	BRIDGEPORT	6604	1
102	CATALYST	MAIN	BRIDGEPORT	6604	2
103	MARKUS		STATE	FAIRFIELD	6603	1
104	LEXUS		PARKAVE	TRUMBULL	6603	2
105	MAX		RENNEL	BRIDGEPORT	6604	3
*/

/* 13 MOST CHEAPEST AND EXPENSIVE ITEM IN MENU */

SELECT MIN(ITEM_COST) AS CHEAPEST_AT_SUBWAY, MAX(ITEM_COST) AS EXPENSIVE_AT_SUBWAY
FROM MENU;


/*
CHEAPEST_AT_SUBWAY	EXPENSIVE_AT_SUBWAY
5			12
*/

/* 14 FULL OUTER JOIN */

SELECT EMPLOYEES.* ,DEPENDENT.*
FROM DEPENDENT
FULL OUTER JOIN EMPLOYEES ON EMPLOYEES.EMP_ID=DEPENDENT.EMPLOYEES_EMP_ID
ORDER BY DEPENDENT.DEPENDENT_ID; 

/*
1010	KSHITIJ   	WAITER		12-APR-17	102	501	ASHISH	RAI	FRIEND	1010	102
1004	SAMUEL    	SECURITY	13-JAN-17	101	502	NITIN	DHARMA	BROTHER	1004	101
1008	NICK      	HELPER		08-NOV-17	103	503	RUTA	PANDEY	SISTER	1008	103
1001	SHASHANK  	CASHIER		15-AUG-18	101	504	KETKI	KADAM	SISTER	1001	101
1006	MAYANK    	HELPER		26-AUG-18	105	505	DANISH	JAIN	BROTHER	1006	105
1009	SCHMITH   	SECURITY	17-SEP-16	103						
1007	OLIVIA    	HELPER		30-OCT-16	104						
1003	KETAN     	WAITER		10-JAN-17	102						
1002	RAJ       	MANAGER		10-JAN-17	101						
1005	AMILA     	MANAGER		16-DEC-18	105	
*/					

/* 15 TARGETTING PARTICLUAR PHONE CARRIERS */

SELECT * FROM CUSTOMER_PROFILE WHERE PHONE LIKE '203%';

/*
3	3456789120	Rachna	Bharadwaj	01-MAR-92	2035764965	FEMALE	6603	MYRTLE	Bridgeport     
4	7894561230	Sunil	Dudhe		14-APR-93	2035761234	MALE  	6603	LINK	Fairfield      
5	9876543210	Dhaval	Bulsara		23-SEP-95	2035034895	MALE  	6603	STATE	Fairfield      
*/